# Day14 ç‹€æ…‹æ¨¡å¼ (State Pattern)

## æ“¬äººåŒ–è§’è‰²ï¼šã€å¤šé‡äººæ ¼çš„è®Šå½¢è¡“å£«ã€‘

![](https://raw.githubusercontent.com/dpes8693/ithome-2025-ironman/refs/heads/main/gemini-img/13-State.png)

- ç¨®æ—ï¼š äººé¡/æ³•å¸«
- å¤–è²Œï¼š ä¸€ä½èº«å½¢æ¨¡ç³Šã€å‘¨åœèƒ½é‡ä¸æ–·è®Šæ›çš„æ³•å¸«ã€‚ä»–å‘¨åœç’°ç¹è‘—å¤šå€‹ä»£è¡¨ä¸åŒå½¢æ…‹ï¼ˆç«ç„°å½¢æ…‹ã€å†°éœœå½¢æ…‹ã€é›·é›»å½¢æ…‹ã€æ½›è¡Œå½¢æ…‹ï¼‰çš„é­”æ³•è™›å½±ã€‚æ¯å€‹å½¢æ…‹éƒ½æœ‰ç¨ç‰¹çš„æ­¦å™¨å’Œè¡¨æƒ…ã€‚ä»–èº«è™•ä¸€å€‹å……æ»¿é­”æ³•ç¬¦æ–‡å’Œæ‡¸æµ®æ°´æ™¶çš„åœ“å½¢ç¥­å£‡ä¸­å¤®ã€‚
- æ€§æ ¼ï¼š å¤šè®Šã€é©æ‡‰æ€§å¼·ï¼Œä½†æ¯å€‹ã€Œäººæ ¼ã€éƒ½éµå¾ªè‡ªå·±çš„è¦å‰‡ã€‚ä»–æœ¬èº«çš„è¡Œç‚ºæœƒå®Œå…¨ç”±ç•¶å‰æ‰€è™•çš„ã€Œç‹€æ…‹ã€ä¾†æ±ºå®šã€‚
- èƒ½åŠ›ï¼š å°‡ç‰©ä»¶çš„ç‹€æ…‹å°è£æˆé¡åˆ¥ï¼Œè®“ç‰©ä»¶éš¨è‘—ç‹€æ…‹æ”¹è®Šæ™‚èƒ½æœ‰ä¸åŒçš„è¡Œç‚ºã€‚é€™ä½è®Šå½¢è¡“å£«ï¼ˆä¸Šä¸‹æ–‡ç‰©ä»¶ï¼‰æœ¬èº«ä¸¦ä¸æœƒç›´æ¥æ±ºå®šè‡ªå·±çš„è¡Œç‚ºï¼Œè€Œæ˜¯å°‡ä¸åŒçš„ã€Œç‹€æ…‹ã€ï¼ˆå¦‚ã€Œç«ç„°ç‹‚æ€’ç‹€æ…‹ã€ã€ã€Œå†°éœœé˜²ç¦¦ç‹€æ…‹ã€ã€ã€Œé›·é›»çªè¥²ç‹€æ…‹ã€ã€ã€Œæ½›ä¼éš±åŒ¿ç‹€æ…‹ã€ï¼‰å°è£æˆä¸åŒçš„ç¨ç«‹å¯¦é«”ã€‚ç•¶è¡“å£«é€²å…¥ã€Œç«ç„°ç‹€æ…‹ã€æ™‚ï¼Œä»–çš„æ‰€æœ‰è¡Œç‚ºéƒ½æœƒè®Šç‚ºé‡‹æ”¾ç«ç„°æ³•è¡“ï¼›é€²å…¥ã€Œå†°éœœç‹€æ…‹ã€æ™‚ï¼Œå‰‡æœƒå°ˆæ³¨æ–¼é˜²ç¦¦å’Œå†°å‡ã€‚
- ä»£è¡¨èªï¼š ã€Œæˆ‘éæˆ‘ï¼Œæˆ‘ç‚ºæ­¤åˆ»ä¹‹å½¢ã€‚ã€
- èƒŒæ™¯æ•…äº‹ï¼š é€™ä½ç¥ç§˜çš„è®Šå½¢è¡“å£«æ“æœ‰æ”¹è®Šè‡ªèº«å±¬æ€§å’Œèƒ½åŠ›çš„å¥‡ç‰¹å¤©è³¦ã€‚åœ¨æˆ°é¬¥ä¸­ï¼Œä»–å¯ä»¥æ ¹æ“šéœ€è¦éš¨æ™‚åˆ‡æ›å½¢æ…‹ã€‚ç•¶é¢å°ä¸€ç¾¤æ•µäººæ™‚ï¼Œä»–æœƒé€²å…¥ã€Œç«ç„°ç‹‚æ€’ç‹€æ…‹ã€ï¼Œé‡‹æ”¾é‹ªå¤©è“‹åœ°çš„ç«çƒè¡“ï¼›ç•¶éœ€è¦ä¿è­·éšŠå‹æ™‚ï¼Œå‰‡åˆ‡æ›åˆ°ã€Œå†°éœœé˜²ç¦¦ç‹€æ…‹ã€ï¼Œç¯‰èµ·å†°ç‰†ã€‚ä»–çš„åŠ›é‡ä¸åœ¨æ–¼æ–½å±•å–®ä¸€å¼·å¤§æ³•è¡“ï¼Œè€Œåœ¨æ–¼èƒ½éˆæ´»åœ°åˆ‡æ›ä¸åŒã€Œç‹€æ…‹ã€ï¼Œä»¥æ‡‰å°å„ç¨®å±€é¢ã€‚è¡“å£«æœ¬èº«åªæ˜¯é€™äº›ç‹€æ…‹çš„å®¹å™¨ï¼ŒçœŸæ­£çš„ã€Œè¡Œç‚ºé‚è¼¯ã€éƒ½å¯«åœ¨é€™äº›ç‹€æ…‹ä¹‹ä¸­ã€‚

---

## ç¯„ä¾‹

### Java

```java
//MageState.java
// æ³•å¸«ç‹€æ…‹ä»‹é¢
public interface MageState {
    void cast();
    void defend();
    void move();
    String getFormName();
}
```

```java
//FireState.java
// ç«ç„°ç‹‚æ€’ç‹€æ…‹
public class FireState implements MageState {
    @Override
    public void cast() {
        System.out.println("ğŸ”¥ ç«ç„°çˆ†ç™¼ï¼é‡‹æ”¾å¤§ç¯„åœç«çƒè¡“ï¼");
    }

    @Override
    public void defend() {
        System.out.println("ğŸ”¥ ç«ç„°è­·ç›¾å±•é–‹ï¼Œç‡’æ¯€ä¾†çŠ¯æ•µäººï¼");
    }

    @Override
    public void move() {
        System.out.println("ğŸ”¥ ç«ç„°è¡åˆºï¼Œç•™ä¸‹ç‡ƒç‡’è¶³è·¡ï¼");
    }

    @Override
    public String getFormName() {
        return "ç«ç„°ç‹‚æ€’å½¢æ…‹";
    }
}
```

```java
//IceState.java
// å†°éœœé˜²ç¦¦ç‹€æ…‹
public class IceState implements MageState {
    @Override
    public void cast() {
        System.out.println("â„ï¸ å†°éœœé¢¨æš´ï¼å‡çµæ‰€æœ‰æ•µäººï¼");
    }

    @Override
    public void defend() {
        System.out.println("â„ï¸ å …å›ºå†°ç‰†å‡èµ·ï¼Œå½¢æˆçµ•å°é˜²è­·ï¼");
    }

    @Override
    public void move() {
        System.out.println("â„ï¸ å†°é¢æ»‘è¡Œï¼Œå„ªé›…ä¸”è¿…é€Ÿï¼");
    }

    @Override
    public String getFormName() {
        return "å†°éœœé˜²ç¦¦å½¢æ…‹";
    }
}
```

```java
//LightningState.java
// é›·é›»çªè¥²ç‹€æ…‹
public class LightningState implements MageState {
    @Override
    public void cast() {
        System.out.println("âš¡ é›·éœ†è¬éˆï¼é–ƒé›»éˆé€£çºŒæ‰“æ“Šï¼");
    }

    @Override
    public void defend() {
        System.out.println("âš¡ é›·é›»è­·ç½©åå½ˆæ”»æ“Šï¼");
    }

    @Override
    public void move() {
        System.out.println("âš¡ é–ƒé›»ç¬ç§»ï¼Œç¬é–“å‡ºç¾åœ¨æ•µäººèº«å¾Œï¼");
    }

    @Override
    public String getFormName() {
        return "é›·é›»çªè¥²å½¢æ…‹";
    }
}
```

```java
//StealthState.java
// æ½›ä¼éš±åŒ¿ç‹€æ…‹
public class StealthState implements MageState {
    @Override
    public void cast() {
        System.out.println("ğŸŒ™ æš—å½±ç®­çŸ¢ï¼Œç„¡è²ç„¡æ¯å‘½ä¸­è¦å®³ï¼");
    }

    @Override
    public void defend() {
        System.out.println("ğŸŒ™ å½±åˆ†èº«è¡“ï¼ŒçœŸèº«æ¶ˆå¤±åœ¨é™°å½±ä¸­ï¼");
    }

    @Override
    public void move() {
        System.out.println("ğŸŒ™ å¦‚å½±éš¨è¡Œï¼Œæ‚„ç„¡è²æ¯åœ°æ½›è¡Œï¼");
    }

    @Override
    public String getFormName() {
        return "æ½›ä¼éš±åŒ¿å½¢æ…‹";
    }
}
```

```java
//ShapeshifterMage.java
// è®Šå½¢è¡“å£«ï¼ˆContextä¸Šä¸‹æ–‡ï¼‰
public class ShapeshifterMage {
    private MageState currentState;
    private String name;

    public ShapeshifterMage(String name) {
        this.name = name;
        // é è¨­ç‹€æ…‹ç‚ºç«ç„°å½¢æ…‹
        this.currentState = new FireState();
    }

    // åˆ‡æ›ç‹€æ…‹
    public void changeState(MageState newState) {
        this.currentState = newState;
        System.out.println("âœ¨ " + name + " è®Šå½¢ç‚ºï¼š" + currentState.getFormName());
    }

    // å§”è¨—çµ¦ç•¶å‰ç‹€æ…‹åŸ·è¡Œå‹•ä½œ
    public void cast() {
        System.out.print(name + " - ");
        currentState.cast();
    }

    public void defend() {
        System.out.print(name + " - ");
        currentState.defend();
    }

    public void move() {
        System.out.print(name + " - ");
        currentState.move();
    }

    public String getCurrentForm() {
        return currentState.getFormName();
    }

    // å±•ç¤ºæ‰€æœ‰å¯ç”¨å½¢æ…‹
    public void showAvailableForms() {
        System.out.println("=== " + name + " çš„è®Šå½¢èƒ½åŠ› ===");
        System.out.println("ğŸ”¥ ç«ç„°ç‹‚æ€’å½¢æ…‹ - å¼·åŠ›æ”»æ“Š");
        System.out.println("â„ï¸ å†°éœœé˜²ç¦¦å½¢æ…‹ - å …å›ºé˜²å®ˆ");
        System.out.println("âš¡ é›·é›»çªè¥²å½¢æ…‹ - å¿«é€Ÿæ‰“æ“Š");
        System.out.println("ğŸŒ™ æ½›ä¼éš±åŒ¿å½¢æ…‹ - éš±å¯†è¡Œå‹•");
        System.out.println("ã€Œæˆ‘éæˆ‘ï¼Œæˆ‘ç‚ºæ­¤åˆ»ä¹‹å½¢ã€‚ã€");
    }
}
```

```java
//StatePatternExample.java
// ä½¿ç”¨ç¯„ä¾‹
public class StatePatternExample {
    public static void main(String[] args) {
        System.out.println("=== æ­¡è¿ä¾†åˆ°è®Šå½¢è¡“å£«çš„é­”æ³•æ®¿å ‚ ===\n");

        // å‰µå»ºè®Šå½¢è¡“å£«
        ShapeshifterMage mage = new ShapeshifterMage("è‰¾è‰å®‰å¨œ");

        // å±•ç¤ºèƒ½åŠ›
        mage.showAvailableForms();
        System.out.println();

        // æ¸¬è©¦ç«ç„°å½¢æ…‹ï¼ˆé è¨­ï¼‰
        System.out.println("ç•¶å‰å½¢æ…‹ï¼š" + mage.getCurrentForm());
        mage.cast();
        mage.defend();
        mage.move();
        System.out.println();

        // åˆ‡æ›åˆ°å†°éœœé˜²ç¦¦å½¢æ…‹
        mage.changeState(new IceState());
        mage.cast();
        mage.defend();
        mage.move();
        System.out.println();

        // åˆ‡æ›åˆ°é›·é›»çªè¥²å½¢æ…‹
        mage.changeState(new LightningState());
        mage.cast();
        mage.defend();
        mage.move();
        System.out.println();

        // åˆ‡æ›åˆ°æ½›ä¼éš±åŒ¿å½¢æ…‹
        mage.changeState(new StealthState());
        mage.cast();
        mage.defend();
        mage.move();

        /**output
        === æ­¡è¿ä¾†åˆ°è®Šå½¢è¡“å£«çš„é­”æ³•æ®¿å ‚ ===

        === è‰¾è‰å®‰å¨œ çš„è®Šå½¢èƒ½åŠ› ===
        ğŸ”¥ ç«ç„°ç‹‚æ€’å½¢æ…‹ - å¼·åŠ›æ”»æ“Š
        â„ï¸ å†°éœœé˜²ç¦¦å½¢æ…‹ - å …å›ºé˜²å®ˆ
        âš¡ é›·é›»çªè¥²å½¢æ…‹ - å¿«é€Ÿæ‰“æ“Š
        ğŸŒ™ æ½›ä¼éš±åŒ¿å½¢æ…‹ - éš±å¯†è¡Œå‹•
        ã€Œæˆ‘éæˆ‘ï¼Œæˆ‘ç‚ºæ­¤åˆ»ä¹‹å½¢ã€‚ã€

        ç•¶å‰å½¢æ…‹ï¼šç«ç„°ç‹‚æ€’å½¢æ…‹
        è‰¾è‰å®‰å¨œ - ğŸ”¥ ç«ç„°çˆ†ç™¼ï¼é‡‹æ”¾å¤§ç¯„åœç«çƒè¡“ï¼
        è‰¾è‰å®‰å¨œ - ğŸ”¥ ç«ç„°è­·ç›¾å±•é–‹ï¼Œç‡’æ¯€ä¾†çŠ¯æ•µäººï¼
        è‰¾è‰å®‰å¨œ - ğŸ”¥ ç«ç„°è¡åˆºï¼Œç•™ä¸‹ç‡ƒç‡’è¶³è·¡ï¼

        âœ¨ è‰¾è‰å®‰å¨œ è®Šå½¢ç‚ºï¼šå†°éœœé˜²ç¦¦å½¢æ…‹
        è‰¾è‰å®‰å¨œ - â„ï¸ å†°éœœé¢¨æš´ï¼å‡çµæ‰€æœ‰æ•µäººï¼
        è‰¾è‰å®‰å¨œ - â„ï¸ å …å›ºå†°ç‰†å‡èµ·ï¼Œå½¢æˆçµ•å°é˜²è­·ï¼
        è‰¾è‰å®‰å¨œ - â„ï¸ å†°é¢æ»‘è¡Œï¼Œå„ªé›…ä¸”è¿…é€Ÿï¼

        âœ¨ è‰¾è‰å®‰å¨œ è®Šå½¢ç‚ºï¼šé›·é›»çªè¥²å½¢æ…‹
        è‰¾è‰å®‰å¨œ - âš¡ é›·éœ†è¬éˆï¼é–ƒé›»éˆé€£çºŒæ‰“æ“Šï¼
        è‰¾è‰å®‰å¨œ - âš¡ é›·é›»è­·ç½©åå½ˆæ”»æ“Šï¼
        è‰¾è‰å®‰å¨œ - âš¡ é–ƒé›»ç¬ç§»ï¼Œç¬é–“å‡ºç¾åœ¨æ•µäººèº«å¾Œï¼

        âœ¨ è‰¾è‰å®‰å¨œ è®Šå½¢ç‚ºï¼šæ½›ä¼éš±åŒ¿å½¢æ…‹
        è‰¾è‰å®‰å¨œ - ğŸŒ™ æš—å½±ç®­çŸ¢ï¼Œç„¡è²ç„¡æ¯å‘½ä¸­è¦å®³ï¼
        è‰¾è‰å®‰å¨œ - ğŸŒ™ å½±åˆ†èº«è¡“ï¼ŒçœŸèº«æ¶ˆå¤±åœ¨é™°å½±ä¸­ï¼
        è‰¾è‰å®‰å¨œ - ğŸŒ™ å¦‚å½±éš¨è¡Œï¼Œæ‚„ç„¡è²æ¯åœ°æ½›è¡Œï¼
        */
    }
}
```

### JavaScript

```javascript
// æ³•å¸«ç‹€æ…‹åŸºé¡
class MageState {
  cast() {
    throw new Error("å­é¡å¿…é ˆå¯¦ç¾ cast æ–¹æ³•");
  }

  defend() {
    throw new Error("å­é¡å¿…é ˆå¯¦ç¾ defend æ–¹æ³•");
  }

  move() {
    throw new Error("å­é¡å¿…é ˆå¯¦ç¾ move æ–¹æ³•");
  }

  getFormName() {
    throw new Error("å­é¡å¿…é ˆå¯¦ç¾ getFormName æ–¹æ³•");
  }
}

// ç«ç„°ç‹‚æ€’ç‹€æ…‹
class FireState extends MageState {
  cast() {
    console.log("ğŸ”¥ ç«ç„°çˆ†ç™¼ï¼é‡‹æ”¾å¤§ç¯„åœç«çƒè¡“ï¼");
  }

  defend() {
    console.log("ğŸ”¥ ç«ç„°è­·ç›¾å±•é–‹ï¼Œç‡’æ¯€ä¾†çŠ¯æ•µäººï¼");
  }

  move() {
    console.log("ğŸ”¥ ç«ç„°è¡åˆºï¼Œç•™ä¸‹ç‡ƒç‡’è¶³è·¡ï¼");
  }

  getFormName() {
    return "ç«ç„°ç‹‚æ€’å½¢æ…‹";
  }
}

// å†°éœœé˜²ç¦¦ç‹€æ…‹
class IceState extends MageState {
  cast() {
    console.log("â„ï¸ å†°éœœé¢¨æš´ï¼å‡çµæ‰€æœ‰æ•µäººï¼");
  }

  defend() {
    console.log("â„ï¸ å …å›ºå†°ç‰†å‡èµ·ï¼Œå½¢æˆçµ•å°é˜²è­·ï¼");
  }

  move() {
    console.log("â„ï¸ å†°é¢æ»‘è¡Œï¼Œå„ªé›…ä¸”è¿…é€Ÿï¼");
  }

  getFormName() {
    return "å†°éœœé˜²ç¦¦å½¢æ…‹";
  }
}

// é›·é›»çªè¥²ç‹€æ…‹
class LightningState extends MageState {
  cast() {
    console.log("âš¡ é›·éœ†è¬éˆï¼é–ƒé›»éˆé€£çºŒæ‰“æ“Šï¼");
  }

  defend() {
    console.log("âš¡ é›·é›»è­·ç½©åå½ˆæ”»æ“Šï¼");
  }

  move() {
    console.log("âš¡ é–ƒé›»ç¬ç§»ï¼Œç¬é–“å‡ºç¾åœ¨æ•µäººèº«å¾Œï¼");
  }

  getFormName() {
    return "é›·é›»çªè¥²å½¢æ…‹";
  }
}

// æ½›ä¼éš±åŒ¿ç‹€æ…‹
class StealthState extends MageState {
  cast() {
    console.log("ğŸŒ™ æš—å½±ç®­çŸ¢ï¼Œç„¡è²ç„¡æ¯å‘½ä¸­è¦å®³ï¼");
  }

  defend() {
    console.log("ğŸŒ™ å½±åˆ†èº«è¡“ï¼ŒçœŸèº«æ¶ˆå¤±åœ¨é™°å½±ä¸­ï¼");
  }

  move() {
    console.log("ğŸŒ™ å¦‚å½±éš¨è¡Œï¼Œæ‚„ç„¡è²æ¯åœ°æ½›è¡Œï¼");
  }

  getFormName() {
    return "æ½›ä¼éš±åŒ¿å½¢æ…‹";
  }
}

// è®Šå½¢è¡“å£«ï¼ˆContextä¸Šä¸‹æ–‡ï¼‰
class ShapeshifterMage {
  constructor(name) {
    this.name = name;
    // é è¨­ç‹€æ…‹ç‚ºç«ç„°å½¢æ…‹
    this.currentState = new FireState();
  }

  // åˆ‡æ›ç‹€æ…‹
  changeState(newState) {
    this.currentState = newState;
    console.log(`âœ¨ ${this.name} è®Šå½¢ç‚ºï¼š${this.currentState.getFormName()}`);
  }

  // å§”è¨—çµ¦ç•¶å‰ç‹€æ…‹åŸ·è¡Œå‹•ä½œ
  cast() {
    process.stdout.write(`${this.name} - `);
    this.currentState.cast();
  }

  defend() {
    process.stdout.write(`${this.name} - `);
    this.currentState.defend();
  }

  move() {
    process.stdout.write(`${this.name} - `);
    this.currentState.move();
  }

  getCurrentForm() {
    return this.currentState.getFormName();
  }

  // å±•ç¤ºæ‰€æœ‰å¯ç”¨å½¢æ…‹
  showAvailableForms() {
    console.log(`=== ${this.name} çš„è®Šå½¢èƒ½åŠ› ===`);
    console.log("ğŸ”¥ ç«ç„°ç‹‚æ€’å½¢æ…‹ - å¼·åŠ›æ”»æ“Š");
    console.log("â„ï¸ å†°éœœé˜²ç¦¦å½¢æ…‹ - å …å›ºé˜²å®ˆ");
    console.log("âš¡ é›·é›»çªè¥²å½¢æ…‹ - å¿«é€Ÿæ‰“æ“Š");
    console.log("ğŸŒ™ æ½›ä¼éš±åŒ¿å½¢æ…‹ - éš±å¯†è¡Œå‹•");
    console.log("ã€Œæˆ‘éæˆ‘ï¼Œæˆ‘ç‚ºæ­¤åˆ»ä¹‹å½¢ã€‚ã€");
  }
}

// ä½¿ç”¨ç¯„ä¾‹
console.log("=== æ­¡è¿ä¾†åˆ°è®Šå½¢è¡“å£«çš„é­”æ³•æ®¿å ‚ ===\n");

// å‰µå»ºè®Šå½¢è¡“å£«
const mage = new ShapeshifterMage("è‰¾è‰å®‰å¨œ");

// å±•ç¤ºèƒ½åŠ›
mage.showAvailableForms();
console.log();

// æ¸¬è©¦ç«ç„°å½¢æ…‹ï¼ˆé è¨­ï¼‰
console.log(`ç•¶å‰å½¢æ…‹ï¼š${mage.getCurrentForm()}`);
mage.cast();
mage.defend();
mage.move();
console.log();

// åˆ‡æ›åˆ°å†°éœœé˜²ç¦¦å½¢æ…‹
mage.changeState(new IceState());
mage.cast();
mage.defend();
mage.move();
console.log();

// åˆ‡æ›åˆ°é›·é›»çªè¥²å½¢æ…‹
mage.changeState(new LightningState());
mage.cast();
mage.defend();
mage.move();
console.log();

// åˆ‡æ›åˆ°æ½›ä¼éš±åŒ¿å½¢æ…‹
mage.changeState(new StealthState());
mage.cast();
mage.defend();
mage.move();

/** output
=== æ­¡è¿ä¾†åˆ°è®Šå½¢è¡“å£«çš„é­”æ³•æ®¿å ‚ ===

=== è‰¾è‰å®‰å¨œ çš„è®Šå½¢èƒ½åŠ› ===
ğŸ”¥ ç«ç„°ç‹‚æ€’å½¢æ…‹ - å¼·åŠ›æ”»æ“Š
â„ï¸ å†°éœœé˜²ç¦¦å½¢æ…‹ - å …å›ºé˜²å®ˆ
âš¡ é›·é›»çªè¥²å½¢æ…‹ - å¿«é€Ÿæ‰“æ“Š
ğŸŒ™ æ½›ä¼éš±åŒ¿å½¢æ…‹ - éš±å¯†è¡Œå‹•
ã€Œæˆ‘éæˆ‘ï¼Œæˆ‘ç‚ºæ­¤åˆ»ä¹‹å½¢ã€‚ã€

ç•¶å‰å½¢æ…‹ï¼šç«ç„°ç‹‚æ€’å½¢æ…‹
è‰¾è‰å®‰å¨œ - ğŸ”¥ ç«ç„°çˆ†ç™¼ï¼é‡‹æ”¾å¤§ç¯„åœç«çƒè¡“ï¼
è‰¾è‰å®‰å¨œ - ğŸ”¥ ç«ç„°è­·ç›¾å±•é–‹ï¼Œç‡’æ¯€ä¾†çŠ¯æ•µäººï¼
è‰¾è‰å®‰å¨œ - ğŸ”¥ ç«ç„°è¡åˆºï¼Œç•™ä¸‹ç‡ƒç‡’è¶³è·¡ï¼

âœ¨ è‰¾è‰å®‰å¨œ è®Šå½¢ç‚ºï¼šå†°éœœé˜²ç¦¦å½¢æ…‹
è‰¾è‰å®‰å¨œ - â„ï¸ å†°éœœé¢¨æš´ï¼å‡çµæ‰€æœ‰æ•µäººï¼
è‰¾è‰å®‰å¨œ - â„ï¸ å …å›ºå†°ç‰†å‡èµ·ï¼Œå½¢æˆçµ•å°é˜²è­·ï¼
è‰¾è‰å®‰å¨œ - â„ï¸ å†°é¢æ»‘è¡Œï¼Œå„ªé›…ä¸”è¿…é€Ÿï¼

âœ¨ è‰¾è‰å®‰å¨œ è®Šå½¢ç‚ºï¼šé›·é›»çªè¥²å½¢æ…‹
è‰¾è‰å®‰å¨œ - âš¡ é›·éœ†è¬éˆï¼é–ƒé›»éˆé€£çºŒæ‰“æ“Šï¼
è‰¾è‰å®‰å¨œ - âš¡ é›·é›»è­·ç½©åå½ˆæ”»æ“Šï¼
è‰¾è‰å®‰å¨œ - âš¡ é–ƒé›»ç¬ç§»ï¼Œç¬é–“å‡ºç¾åœ¨æ•µäººèº«å¾Œï¼

âœ¨ è‰¾è‰å®‰å¨œ è®Šå½¢ç‚ºï¼šæ½›ä¼éš±åŒ¿å½¢æ…‹
è‰¾è‰å®‰å¨œ - ğŸŒ™ æš—å½±ç®­çŸ¢ï¼Œç„¡è²ç„¡æ¯å‘½ä¸­è¦å®³ï¼
è‰¾è‰å®‰å¨œ - ğŸŒ™ å½±åˆ†èº«è¡“ï¼ŒçœŸèº«æ¶ˆå¤±åœ¨é™°å½±ä¸­ï¼
è‰¾è‰å®‰å¨œ - ğŸŒ™ å¦‚å½±éš¨è¡Œï¼Œæ‚„ç„¡è²æ¯åœ°æ½›è¡Œï¼
 */
```

## å°ç¸½çµ

State è¨­è¨ˆæ¨¡å¼å°±åƒæˆ‘å€‘æ•…äº‹ä¸­çš„å¤šé‡äººæ ¼è®Šå½¢è¡“å£«ï¼Œè®“ç‰©ä»¶èƒ½å¤ `æ ¹æ“šå…§éƒ¨ç‹€æ…‹æ”¹è®Šå…¶è¡Œç‚º`

**æ ¸å¿ƒç‰¹é»ï¼š**

- **ç‹€æ…‹å°è£**ï¼šå°‡æ¯å€‹ç‹€æ…‹å°è£æˆç¨ç«‹çš„é¡åˆ¥ï¼Œå„è‡ªè™•ç†è©²ç‹€æ…‹ä¸‹çš„è¡Œç‚º
- **è¡Œç‚ºå§”è¨—**ï¼šä¸Šä¸‹æ–‡ç‰©ä»¶å°‡è¡Œç‚ºå§”è¨—çµ¦ç•¶å‰ç‹€æ…‹ç‰©ä»¶åŸ·è¡Œ
- **ç‹€æ…‹åˆ‡æ›**ï¼šå¯ä»¥å‹•æ…‹åœ°åˆ‡æ›ç‹€æ…‹ï¼Œæ”¹è®Šç‰©ä»¶çš„è¡Œç‚º
- **æ¶ˆé™¤æ¢ä»¶åˆ¤æ–·**ï¼šé¿å…åœ¨ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨å¤§é‡çš„ if-else æˆ– switch èªå¥

**ä½¿ç”¨æ™‚æ©Ÿï¼š**

- ç‰©ä»¶çš„è¡Œç‚ºæœƒéš¨è‘—å…§éƒ¨ç‹€æ…‹æ”¹è®Šè€Œæœ‰æ‰€ä¸åŒï¼ˆex: éŠæˆ²è§’è‰²çš„ä¸åŒç‹€æ…‹ï¼‰
- æœ‰å¤§é‡èˆ‡ç‹€æ…‹ç›¸é—œçš„æ¢ä»¶èªå¥éœ€è¦ç°¡åŒ–ï¼ˆex: ç‹€æ…‹æ©Ÿã€å·¥ä½œæµç¨‹ï¼‰

## State Pattern vs Factory Pattern å·®ç•°æ¯”è¼ƒ

### ğŸ¯ **æ ¸å¿ƒç›®çš„å·®ç•°**

| è¨­è¨ˆæ¨¡å¼            | æ ¸å¿ƒç›®çš„                           | é—œæ³¨é‡é»       |
| ------------------- | ---------------------------------- | -------------- |
| **State Pattern**   | è®“ç‰©ä»¶èƒ½å¤ æ ¹æ“š**å…§éƒ¨ç‹€æ…‹æ”¹è®Šè¡Œç‚º** | è¡Œç‚ºçš„å‹•æ…‹åˆ‡æ› |
| **Factory Pattern** | è² è²¬**ç‰©ä»¶çš„å‰µå»ºå’Œé¸æ“‡**           | ç‰©ä»¶çš„å‰µå»ºéç¨‹ |

### ğŸ”„ **ç‰©ä»¶ç”Ÿå‘½é€±æœŸ**

**State Patternï¼š**

- ç‰©ä»¶åœ¨é‹è¡Œæ™‚**å‹•æ…‹åˆ‡æ›ç‹€æ…‹**
- åŒä¸€å€‹ Context ç‰©ä»¶æœƒæŒçºŒå­˜åœ¨ï¼Œåªæ˜¯å…§éƒ¨ç‹€æ…‹æœƒæ”¹è®Š
- ç‹€æ…‹ä¹‹é–“å­˜åœ¨**è½‰æ›é—œä¿‚**å’Œ**ç”Ÿå‘½é€±æœŸ**

**Factory Patternï¼š**

- æ ¹æ“šåƒæ•¸**ä¸€æ¬¡æ€§å‰µå»º**é©ç•¶çš„ç‰©ä»¶
- å‰µå»ºå®Œæˆå¾Œï¼Œç‰©ä»¶é¡å‹é€šå¸¸**ä¸å†æ”¹è®Š**
- å°ˆæ³¨æ–¼**å¦‚ä½•å‰µå»º**ï¼Œè€Œéå‰µå»ºå¾Œçš„è¡Œç‚ºè®ŠåŒ–

### ğŸ® **å¯¦éš›æ‡‰ç”¨å ´æ™¯å°æ¯”**

**State Pattern é©ç”¨å ´æ™¯ï¼š**

```java
// éŠæˆ²è§’è‰²ç‹€æ…‹ï¼šå¥åº· â†’ å—å‚· â†’ ç€•æ­» â†’ æ­»äº¡
GameCharacter character = new GameCharacter();
character.takeDamage(50);    // ç‹€æ…‹ï¼šå¥åº· â†’ å—å‚·
character.takeDamage(30);    // ç‹€æ…‹ï¼šå—å‚· â†’ ç€•æ­»
character.heal(20);          // ç‹€æ…‹ï¼šç€•æ­» â†’ å—å‚·
```

**Factory Pattern é©ç”¨å ´æ™¯ï¼š**

```java
// æ ¹æ“šéœ€æ±‚å‰µå»ºä¸åŒé¡å‹çš„æ­¦å™¨
WeaponFactory factory = new WeaponFactory();
Weapon sword = factory.createWeapon("SWORD");     // å‰µå»ºåŠ
Weapon bow = factory.createWeapon("BOW");         // å‰µå»ºå¼“
// æ­¦å™¨å‰µå»ºå¾Œé¡å‹å›ºå®šï¼Œä¸æœƒè‡ªå‹•è®Šæˆå…¶ä»–æ­¦å™¨
```
